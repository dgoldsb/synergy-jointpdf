function [results]=testGrowthRate(model, limiting)

    % This function compares model predictions of biomass flux to growth
    % rates as in doi:10.1186/1752-0509-7-36. This simulation uses a
    % minimal medium with glucose as the carbon source, the iFF708 biomas
    % objective, and predicts biomass yields under carbon or nitrogen
    % limitations aerobically (most models do not predict anaerobic growth
    % without media supplementation).
    %
    % Input:
    %   model     A COBRA Toolbox-format yeast model. Currently supports:
    %              iFF708 - doi: 10.1101/gr.234503
    %              iND750 - doi: 10.1101/gr.2250904
    %              iIN800 - doi: 10.1186/1752-0509-2-71
    %              iMM904 - doi: 10.1186/1752-0509-3-37
    %              Yeast 4 - doi: 10.1186/1752-0509-4-145
    %              iAZ900 - doi: 10.1186/1752-0509-4-178
    %              iMM904bz - doi: 10.1038/ng.846
    %              Yeast 5 - doi:10.1186/1752-0509-6-55
    %              iTO977 - doi:10.1186/1752-0509-7-36
    %              Yeast 6 - doi:10.1093/database/bat059
    %              Yeast 7 - doi:10.1089/ind.2013.0013
    %              biomodels - doi:10.1186/1752-0509-7-116, downloaded from
    %                https://www.ebi.ac.uk/biomodels-main/BMID000000141353
    %
    %   limiting  1 for a single limiting nutrient, 2 for multiple
    %              constraints
    %
    %
    % Output:
    %   results   correlation (R) between reported experimental growth
    %             rates and calculated maximum achievable biomass flux 
    %             values

    %% citation
    % please cite: Heavner, Benjamin D. and Nathan Price. �Comparing Yeast
    % Metabolic Network Reconstructions� NEED TO ADD CITATION DETAILS
  
    lower(model.description)
    
    switch lower(model.description)
        case {'iff708_valid_modified.xml'}          
            model.c(1368) = 0; % the SBML file has two objectives set
            model = minimal_iFF(model);
            Glu_EX = 'GLCxtI';
            O2_EX = 'O2xtI';
            N_EX = 'NH3xtI';
            exchangeIDs = {Glu_EX, O2_EX, N_EX};
            if limiting == 1
                N_correlation = get_N_limited_correlation(model, exchangeIDs, false)
                % pause
                C_correlation = get_C_limited_correlation(model, exchangeIDs, false)
                % pause
            elseif limiting == 2
                mult_N_correlation = get_multiple_N_limited_correlation(model, exchangeIDs, false)
               % pause
                mult_C_correlation = get_multiple_C_limited_correlation(model, exchangeIDs, false)
               % pause
            end
                    
            
        case {'ind750.xml'}
            model = minimal_iND(model);
            model = set_iND_iFF_biomass(model);
            Glu_EX = 'EX_glc(e)'; 
            O2_EX = 'EX_o2(e)';
            N_EX = 'EX_nh4(e)';
            exchangeIDs = {Glu_EX, O2_EX, N_EX};
            if limiting == 1
                N_correlation = get_N_limited_correlation(model, exchangeIDs, true)
             %   pause
                C_correlation = get_C_limited_correlation(model, exchangeIDs, true)
             %   pause
            elseif limiting == 2
                mult_N_correlation = get_multiple_N_limited_correlation(model, exchangeIDs, true)
             %   pause
                mult_C_correlation = get_multiple_C_limited_correlation(model, exchangeIDs, true)
             %   pause
            end
            
        case {'iin800_cobra'}
            model.c(findRxnIDs(model,'GROWTH')) = 1; % set growth objective
            
            model = addExchangeRxn(model,{'m758'},-1000,0);
            model = addExchangeRxn(model,{'m928'},-1000,0);
            
            % also includes TAG and phosphatidate to enable growth
            model = minimal_iIN(model);
            model = set_iIN_COBRA_iFF_biomass(model);
            Glu_EX = 'GLCxtI';
            O2_EX = 'O2xtI';
            N_EX = 'NH3xtI';
            exchangeIDs = {Glu_EX, O2_EX, N_EX};
            if limiting == 1
                N_correlation = get_N_limited_correlation(model, exchangeIDs, false)
            %    pause
                C_correlation = get_C_limited_correlation(model, exchangeIDs, false)
            %    pause
            elseif limiting == 2
                mult_N_correlation = get_multiple_N_limited_correlation(model, exchangeIDs, false)
            %    pause
                mult_C_correlation = get_multiple_C_limited_correlation(model, exchangeIDs, false)
            %    pause
            end
                
        case {'iin800.xml'}
            model = minimal_iIN2(model);
            model = set_iIN_iFF_biomass(model);
            Glu_EX = 'GLCxtI';
            O2_EX = 'O2xtI';
            N_EX = 'NH3xtI';
            exchangeIDs = {Glu_EX, O2_EX, N_EX};
            if limiting == 1
                N_correlation = get_N_limited_correlation(model, exchangeIDs, false)
            %    pause
                C_correlation = get_C_limited_correlation(model, exchangeIDs, false)
            %    pause
            elseif limiting == 2
                mult_N_correlation = get_multiple_N_limited_correlation(model, exchangeIDs, false)
            %    pause
                mult_C_correlation = get_multiple_C_limited_correlation(model, exchangeIDs, false)
            %    pause
            end
            
        case {'imm904'} % should have - constraints
            model = minimal_iMM(model);
            model = set_iMM_iFF_biomass(model);
            Glu_EX = 'EX_glc(e)'; 
            O2_EX = 'EX_o2(e)';
            N_EX = 'EX_nh4(e)';
            exchangeIDs = {Glu_EX, O2_EX, N_EX};
            if limiting == 1
                N_correlation = get_N_limited_correlation(model, exchangeIDs, true)
             %   pause
                C_correlation = get_C_limited_correlation(model, exchangeIDs, true)
             %   pause
            elseif limiting == 2
                mult_N_correlation = get_multiple_N_limited_correlation(model, exchangeIDs, true)
            %    pause
                mult_C_correlation = get_multiple_C_limited_correlation(model, exchangeIDs, true)
            %    pause
            end
            
        case {'yeast_4.05'} % nonstandard exchange bounds
            model = minimal_Y4(model);
            model = set_Y4_iFF_biomass(model);
            Glu_EX = 'r_1293';
            O2_EX = 'r_1435';
            N_EX = 'r_1157';
            exchangeIDs = {Glu_EX, O2_EX, N_EX};
            if limiting == 1
                N_correlation = get_N_limited_correlation(model, exchangeIDs, false)
             %   pause
                C_correlation = get_C_limited_correlation(model, exchangeIDs, false)
             %   pause
            elseif limiting == 2
                mult_N_correlation = get_multiple_N_limited_correlation(model, exchangeIDs, false)
             %   pause
                mult_C_correlation = get_multiple_C_limited_correlation(model, exchangeIDs, false)
             %   pause
            end
            
        case {'iaz900.xml'}
           model = minimal_iAZ(model);
           model = set_iAZ_iFF_biomass(model);
            Glu_EX = 'EX_glc(e)'; 
            O2_EX = 'EX_o2(e)';
            N_EX = 'EX_nh4(e)';
            exchangeIDs = {Glu_EX, O2_EX, N_EX};
            if limiting == 1
                N_correlation = get_N_limited_correlation(model, exchangeIDs, true)
             %   pause
                C_correlation = get_C_limited_correlation(model, exchangeIDs, true)
             %   pause
            elseif limiting == 2
                mult_N_correlation = get_multiple_N_limited_correlation(model, exchangeIDs, true)
             %   pause
                mult_C_correlation = get_multiple_C_limited_correlation(model, exchangeIDs, true)
             %   pause
            end
           
        case {'imm904_nadcorrected'} % should have - constraints
            model = minimal_iMMbz(model);
            model = set_iMM_NAD_iFF_biomass(model);
            Glu_EX = 'EX_glc(e)'; 
            O2_EX = 'EX_o2(e)';
            N_EX = 'EX_nh4(e)';
            exchangeIDs = {Glu_EX, O2_EX, N_EX};
            if limiting == 1
                N_correlation = get_N_limited_correlation(model, exchangeIDs, true)
            %    pause
                C_correlation = get_C_limited_correlation(model, exchangeIDs, true)
            %    pause
            elseif limiting == 2
                mult_N_correlation = get_multiple_N_limited_correlation(model, exchangeIDs, true)
             %   pause
                mult_C_correlation = get_multiple_C_limited_correlation(model, exchangeIDs, true)
             %   pause
            end
            
        case {'yeast_5.01_model.xml'}
            model = minimal_Y5(model);
            model = set_Y5_iFF_biomass(model);
            Glu_EX = 'r_1714';
            O2_EX = 'r_1992';
            N_EX = 'r_1654';
            exchangeIDs = {Glu_EX, O2_EX, N_EX};
            if limiting == 1
                N_correlation = get_N_limited_correlation(model, exchangeIDs, true)
            %    pause
                C_correlation = get_C_limited_correlation(model, exchangeIDs, true)
            %    pause
            elseif limiting == 2
                mult_N_correlation = get_multiple_N_limited_correlation(model, exchangeIDs, true)
            %    pause
                mult_C_correlation = get_multiple_C_limited_correlation(model, exchangeIDs, true)
            %    pause
            end
            
        case {'ito977_cobra_compatible'}
            model = minimal_iTO(model);
            model = set_iTO_iFF_biomass(model);
            Glu_EX = 'GLCxtI';
            O2_EX = 'O2xtI';
            N_EX = 'NH3xtI';
            exchangeIDs = {Glu_EX, O2_EX, N_EX};
            if limiting == 1
                N_correlation = get_N_limited_correlation(model, exchangeIDs, false)
            %    pause
                C_correlation = get_C_limited_correlation(model, exchangeIDs, false)
            %    pause
            elseif limiting == 2
                mult_N_correlation = get_multiple_N_limited_correlation(model, exchangeIDs, false)
            %    pause
                mult_C_correlation = get_multiple_C_limited_correlation(model, exchangeIDs, false)
            %    pause
            end
             
        case {'yeast_6.06_cobra'}
            model = minimal_Y6(model);
            model = set_Y6_iFF_biomass(model);
            Glu_EX = 'r_1714';
            O2_EX = 'r_1992';
            N_EX = 'r_1654';
            exchangeIDs = {Glu_EX, O2_EX, N_EX};
            if limiting == 1
                N_correlation = get_N_limited_correlation(model, exchangeIDs, true)
             %   pause
                C_correlation = get_C_limited_correlation(model, exchangeIDs, true)
             %   pause
            elseif limiting == 2
                mult_N_correlation = get_multiple_N_limited_correlation(model, exchangeIDs, true)
            %    pause
                mult_C_correlation = get_multiple_C_limited_correlation(model, exchangeIDs, true)
            %    pause
            end

        case {'yeast_7.00_cobra'}
            model = minimal_Y6(model);
            model = set_Y7_iFF_biomass(model);
            Glu_EX = 'r_1714';
            O2_EX = 'r_1992';
            N_EX = 'r_1654';
            exchangeIDs = {Glu_EX, O2_EX, N_EX};
            if limiting == 1
                N_correlation = get_N_limited_correlation(model, exchangeIDs, true)
            %    pause
                C_correlation = get_C_limited_correlation(model, exchangeIDs, true)
            %    pause
            elseif limiting == 2
                mult_N_correlation = get_multiple_N_limited_correlation(model, exchangeIDs, true)
            %    pause
                mult_C_correlation = get_multiple_C_limited_correlation(model, exchangeIDs, true)
            %    pause
            end
            
        case {'bmid000000141353'}
            
            % first for growth, leave defaults of all uptakes allowed. Add
            % amino acids - the supplemental data says the model can't make
            % the following: L-tyrosine (met bigg_tyr_L_bm), L-lysine (met
            % bigg_lys_L_bm), L-isoleucine (met bigg_ile_L_bm), L-arginine
            % (met bigg_arg_L_bm), L-histidine (met bigg_his_L_bm),
            % L-methionine (met bigg_met_L_bm), and L-tryptophan
            % (bigg_trp_L_bm). (note, BY4743 has mutants in his3, leu2, and
            % ura, and something with lys2 and met15)


            % add L-tyrosine by allowing the bigg_tyr_L_out rxn to be
            % reversible
            model.lb(findRxnIDs(model,'bigg_tyr_L_out')) = -1000;

            % add L-lysine by allowing the met bigg_lys_L_out rxn to be
            % reversible
            model.lb(findRxnIDs(model,'bigg_lys_L_out')) = -1000;

            % add L-isoleucine by allowing the met bigg_ile_L_out rxn to be
            % reversible
            model.lb(findRxnIDs(model,'bigg_ile_L_out')) = -1000;

            % add L-arginine by allowing the met bigg_arg_L_out rxn to be
            % reversible
            model.lb(findRxnIDs(model,'bigg_arg_L_out')) = -1000;

            % add L-histidine by allowing the met bigg_his_L_out rxn to be
            % reversible
            model.lb(findRxnIDs(model,'bigg_his_L_out')) = -1000;

            % add L-methionine by allowing the met bigg_met_L_out rxn to be
            % reversible
            model.lb(findRxnIDs(model,'bigg_met_L_out')) = -1000;

            % add L-tryptophan by allowing the met bigg_trp_L_out rxn to be
            % reversible
            model.lb(findRxnIDs(model,'bigg_trp_L_out')) = -1000;
            
            % modify model gene annotation
            model.genes  = regexprep(model.genes,'_i','');
            model.genes  = regexprep(model.genes,'_\d','');
            metaCyc_genes = ~cellfun('isempty',regexp(model.genes,'MetaCyc'));
            model.genes(metaCyc_genes) = {' '};
            
            model = minimal_bio(model);
            model = set_bio_iFF_biomass(model);
            Glu_EX = 'MNXM105_in';
            O2_EX = 'MNXM4_in';
            N_EX = 'MNXM15_in';
            exchangeIDs = {Glu_EX, O2_EX, N_EX};
            N_correlation = get_N_limited_correlation(model, exchangeIDs, true)
           % pause
            C_correlation = get_C_limited_correlation(model, exchangeIDs, true)
          %  pause
    
        otherwise
            error('Sorry, this model is not currently supported.')
            
    end
end

%% get correlations
function correlation = get_N_limited_correlation(model, exhangeIDs, signchange)
% signchange is a logical; if TRUE, use negative bounds for exchange
% constriants

N_limited_aerobic_constraints = ...
        [5.8 2.7 .4; 
        4.83 4.42 .42;
        3.50 7.80 .61;
        4.61 9.20 .74;
        5.67 8.70 .83;
        8 8.80 .90;
        9.45 9.30 1.09;
        12.68 8.2 1.33];
    
    if signchange
        N_limited_aerobic_constraints = N_limited_aerobic_constraints * -1;
    end
    
    N_limited_observed = [.1 .1 .15 .18 .2 .25 .28 .34];
    N_limited_simulated = [];

    for index=1:length(N_limited_aerobic_constraints)
%        model.ub(findRxnIDs(model, exhangeIDs(1))) = N_limited_aerobic_constraints(index,1);
%        model.lb(findRxnIDs(model, exhangeIDs(1))) = N_limited_aerobic_constraints(index,1);

%        model.ub(findRxnIDs(model, exhangeIDs(2))) = N_limited_aerobic_constraints(index,2);
%        model.lb(findRxnIDs(model, exhangeIDs(2))) = N_limited_aerobic_constraints(index,2);

        model.ub(findRxnIDs(model, exhangeIDs(3))) = N_limited_aerobic_constraints(index,3);
        model.lb(findRxnIDs(model, exhangeIDs(3))) = N_limited_aerobic_constraints(index,3);

        sln = optimizeCbModel(model);
        N_limited_simulated(index) = sln.f;
        
    end

    N_correlation = corrcoef(N_limited_observed, N_limited_simulated);
    scatter(N_limited_observed, N_limited_simulated);
    N_limited_observed
    N_limited_simulated
    correlation = N_correlation(1,2);
end

function correlation = get_C_limited_correlation(model, exhangeIDs, signchange)
% signchange is a logical; if TRUE, use negative bounds for exchange
% constriants

C_limited_aerobic_constraints = ...
    [1.15 2.7;
    1.17 2.5;
    1.69 4;
    2.26 5;
    2.88 6.5;
    3.27 7.46;
    3.29 7.8;
    3.88 8;
    6.20 7;
    7.89 6.5;
    13.39 3];
    
    if signchange
        C_limited_aerobic_constraints = C_limited_aerobic_constraints * -1;
    end

C_limited_observed = [.1 .1 .15 .2 .25 .27 .28 .31 .33 .35 .38];
C_limited_simulated = [];

    for index=1:length(C_limited_aerobic_constraints)
        model.ub(findRxnIDs(model, exhangeIDs(1))) = C_limited_aerobic_constraints(index,1);
        model.lb(findRxnIDs(model, exhangeIDs(1))) = C_limited_aerobic_constraints(index,1);

%        model.ub(findRxnIDs(model, exhangeIDs(2))) = C_limited_aerobic_constraints(index,2);
%        model.lb(findRxnIDs(model, exhangeIDs(2))) = C_limited_aerobic_constraints(index,2);

        sln = optimizeCbModel(model);
        C_limited_simulated(index) = sln.f;
    end

    C_correlation = corrcoef(C_limited_observed, C_limited_simulated);
    %scatter(C_limited_observ ed, C_limited_simulated);
%    scatter(C_limited_aerobic_constraints(:,1), C_limited_observed);
%    pause
%    scatter(C_limited_aerobic_constraints(:,1), C_limited_simulated);
%    pause
C_limited_observed
C_limited_simulated
    correlation = C_correlation(1,2);
end

function correlation = get_multiple_N_limited_correlation(model, exhangeIDs, signchange)
% signchange is a logical; if TRUE, use negative bounds for exchange
% constriants

N_limited_aerobic_constraints = ...
        [5.8 2.7 .4; 
        4.83 4.42 .42;
        3.50 7.80 .61;
        4.61 9.20 .74;
        5.67 8.70 .83;
        8 8.80 .96;
        9.45 9.30 1.09;
        12.68 8.2 1.33];
    
    if signchange
        N_limited_aerobic_constraints = N_limited_aerobic_constraints * -1;
    end
    
    N_limited_observed = [.1 .1 .15 .18 .2 .25 .28 .34];
    N_limited_simulated = [];

    for index=1:length(N_limited_aerobic_constraints)
       model.ub(findRxnIDs(model, exhangeIDs(1))) = N_limited_aerobic_constraints(index,1);
       model.lb(findRxnIDs(model, exhangeIDs(1))) = N_limited_aerobic_constraints(index,1);

       model.ub(findRxnIDs(model, exhangeIDs(2))) = N_limited_aerobic_constraints(index,2);
       model.lb(findRxnIDs(model, exhangeIDs(2))) = N_limited_aerobic_constraints(index,2);

        model.ub(findRxnIDs(model, exhangeIDs(3))) = N_limited_aerobic_constraints(index,3);
        model.lb(findRxnIDs(model, exhangeIDs(3))) = N_limited_aerobic_constraints(index,3);

        sln = optimizeCbModel(model);
        N_limited_simulated(index) = sln.f;
        
    end

    N_correlation = corrcoef(N_limited_observed, N_limited_simulated);
    scatter(N_limited_observed, N_limited_simulated);
    N_limited_observed
    N_limited_simulated
    correlation = N_correlation(1,2);
end

function correlation = get_multiple_C_limited_correlation(model, exhangeIDs, signchange)
% signchange is a logical; if TRUE, use negative bounds for exchange
% constriants

C_limited_aerobic_constraints = ...
    [1.15 2.7;
    1.17 2.5;
    1.69 4;
    2.26 5;
    2.88 6.5;
    3.27 7.46;
    3.29 7.8;
    3.88 8;
    6.20 7;
    7.89 6.5;
    13.39 3];
    
    if signchange
        C_limited_aerobic_constraints = C_limited_aerobic_constraints * -1;
    end

C_limited_observed = [.1 .1 .15 .2 .25 .27 .28 .31 .33 .35 .38];
C_limited_simulated = [];

    for index=1:length(C_limited_aerobic_constraints)
        model.ub(findRxnIDs(model, exhangeIDs(1))) = C_limited_aerobic_constraints(index,1);
        model.lb(findRxnIDs(model, exhangeIDs(1))) = C_limited_aerobic_constraints(index,1);

       model.ub(findRxnIDs(model, exhangeIDs(2))) = C_limited_aerobic_constraints(index,2);
       model.lb(findRxnIDs(model, exhangeIDs(2))) = C_limited_aerobic_constraints(index,2);

        sln = optimizeCbModel(model);
        C_limited_simulated(index) = sln.f;
    end

    C_correlation = corrcoef(C_limited_observed, C_limited_simulated);
    %scatter(C_limited_observed, C_limited_simulated);
%    scatter(C_limited_aerobic_constraints(:,1), C_limited_observed);
%    pause
%    scatter(C_limited_aerobic_constraints(:,1), C_limited_simulated);
%    pause
C_limited_observed
  C_limited_simulated
 correlation = C_correlation(1,2);
end

%% functions to set minimal medium
function model = minimal_iFF(model)
    % change iFF model media to minimal - ammonium, glucose, oxygen,
    % phosphate, sulphate
    
    % start with a clean slate: set to unconstrained excretion, no uptake)

    uptake_rxn_ids = {'ZYMSTxtI';'XANxtI';'URIxtI';'UREAxtI';'URAxtI';...
        'THYxtI';'DTxtI';'THMxtI';'SLFxtI';'SUCxtI';'SUCCxtI';...
        'C180xtI';'SPRMxtI';'SORxtI';'NAxtI';'MMETxtI';'SAMxtI';...
        'RFLAVxtI';'PYRxtI';'KxtI';'PIMExtI';'PIxtI';'PEPTxtI';...
        'C160xtI';'O2xtI';'OGTxtI';'OPEPxtI';'NMNxtI';'NH3xtI';...
        'C140xtI';'MIxtI';'MTHNxtI';'MELIxtI';'MLTxtI';'MALxtI';...
        'VALxtI';'TYRxtI';'TRPxtI';'THRxtI';'SERxtI';'PROxtI';...
        'PHExtI';'ORNxtI';'METxtI';'LYSxtI';'LEUxtI';'ILExtI';'HISxtI';...
        'GLNxtI';'GLUxtI';'GLTxtI';'CYSxtI';'ASPxtI';'ASNxtI';'ARGxtI';...
        'ALAxtI';'INSxtI';'HYXNxtI';'GSNxtI';'GNxtI';'GLALxtI';...
        'GLYxtI';'GLxtI';'GLAMxtI';'GABAxtI';'FUMxtI';'FORxtI';'ETHxtI';...
        'ERGOxtI';'DTTPxtI';'RIBxtI';'RMNxtI';'MNTxtI';'DIPEPxtI';...
        'GA6PxtI';'GLACxtI';'FRUxtI';'DUxtI';'DINxtI';'DGxtI';'DCxtI';...
        'DAxtI';'ARABxtI';'CYTSxtI';'CYTDxtI';'CO2xtI';'CITxtI';...
        'CHOxtI';'BTxtI';'BMxtI';'FUCxtI';'MANxtI';'GLCxtI';'TRExtI';...
        'ATNxtI';'PAPxtI';'ADNxtI';'ADxtI';'ACxtI';'ACALxtI';'AONAxtI';...
        'DANNAxtI';'AKGxtI';'PNTOxtI';'LACxtI';};

    excretion_rxn_ids = {'ZYMSTxtO';'XANxtO';'URIxtO';'UREAxtO';...
        'URAxtO';'THYxtO';'DTxtO';'THMxtO';'SLFxtO';'SUCxtO';'SUCCxtO';...
        'C180xtO';'SPRMxtO';'SORxtO';'NAxtO';'MMETxtO';'SAMxtO';...
        'RFLAVxtO';'PYRxtO';'KxtO';'PIMExtO';'PIxtO';'PEPTxtO';...
        'C160xtO';'O2xtO';'OGTxtO';'OPEPxtO';'NMNxtO';'NH3xtO';...
        'C140xtO';'MIxtO';'MTHNxtO';'MELIxtO';'MLTxtO';'MALxtO';...
        'VALxtO';'TYRxtO';'TRPxtO';'THRxtO';'SERxtO';'PROxtO';...
        'PHExtO';'ORNxtO';'METxtO';'LYSxtO';'LEUxtO';'ILExtO';'HISxtO';...
        'GLNxtO';'GLUxtO';'GLTxtO';'CYSxtO';'ASPxtO';'ASNxtO';'ARGxtO';...
        'ALAxtO';'INSxtO';'HYXNxtO';'GSNxtO';'GNxtO';'GLALxtO';...
        'GLYxtO';'GLxtO';'GLAMxtO';'GABAxtO';'FUMxtO';'FORxtO';'ETHxtO';...
        'ERGOxtO';'DTTPxtO';'RIBxtO';'RMNxtO';'MNTxtO';'DIPEPxtO';...
        'GA6PxtO';'GLACxtO';'FRUxtO';'DUxtO';'DINxtO';'DGxtO';'DCxtO';...
        'DAxtO';'ARABxtO';'CYTSxtO';'CYTDxtO';'CO2xtO';'CITxtO';...
        'CHOxtO';'BTxtO';'FUCxtO';'MANxtO';'GLCxtO';'TRExtO';'ATNxtO';...
        'PAPxtO';'ADNxtO';'ADxtO';'ACxtO';'ACALxtO';'AONAxtO';...
        'DANNAxtO';'AKGxtO';'PNTOxtO';'LACxtO';'BMxtO';};

    uptake_rxn_indexes = findRxnIDs(model, uptake_rxn_ids);
    excretion_rxn_indexes = findRxnIDs(model, ...
        excretion_rxn_ids);

    model.lb(uptake_rxn_indexes) = 0;
    model.ub(uptake_rxn_indexes) = 0;
    model.lb(excretion_rxn_indexes) = 0;
    model.ub(excretion_rxn_indexes) = 1000;

    desiredExchanges = {...
        'NH3xtI';  ... % 'ammonium exchange';
        'PIxtI'; ... % 'phosphate exchange';
        'SLFxtI'; ... % 'sulphate exchange'; 
        %'NAxtI'; 
        %'KxtI'; 
        'O2xtI';... % 'oxygen exchange'; 
        };
    glucoseExchange = {...
        'GLCxtI'; ... % D-glucose exchange'
        };
    uptakeRxnIndexes = findRxnIDs(model,desiredExchanges);
    glucoseExchangeIndex = findRxnIDs(model,glucoseExchange);
    if length(uptakeRxnIndexes) ~= 4;
        error('Not all exchange reactions were found.')
    end
    model.ub(uptakeRxnIndexes) = 1000;
    model.ub(glucoseExchangeIndex) = 10;
end

function model = minimal_iND(model)
    % change iND model media to minimal - ammonium, glucose, oxygen,
    % phosphate, sulphate
    
    % start with a clean slate: set all exchange reactions to upper bound =
    % 1000 and lower bound = 0 (ie, unconstrained excretion, no uptake)
    exchangeRxns = findExcRxns(model);
    model.lb(exchangeRxns) = 0;
    model.ub(exchangeRxns) = 1000;
    desiredExchanges = {...
        'EX_nh4(e)'; ... % 'ammonium exchange';
        'EX_o2(e)'; ... % 'oxygen exchange'; 
        'EX_pi(e)'; ... % 'phosphate exchange';
        'EX_so4(e)'; ... % 'sulphate exchange'; 
        };
    glucoseExchange = {...
        'EX_glc(e)'; ... % D-glucose exchange'
        };
    uptakeRxnIndexes = findRxnIDs(model,desiredExchanges);
    glucoseExchangeIndex = findRxnIDs(model,glucoseExchange);
    if length(uptakeRxnIndexes) ~= 4;
        error('Not all exchange reactions were found.')
    end
    model.lb(uptakeRxnIndexes)=-1000;
    model.lb(glucoseExchangeIndex)=-10;
end

function model = minimal_iMM(model)
    % change iMM model media to minimal - ammonium, glucose, oxygen,
    % phosphate, sulphate
    
    % start with a clean slate: set all exchange reactions to upper bound =
    % 1000 and lower bound = 0 (ie, unconstrained excretion, no uptake)
    exchangeRxns = findExcRxns(model);
    model.lb(exchangeRxns) = 0;
    model.ub(exchangeRxns) = 1000;
    desiredExchanges = {...
        'EX_nh4(e)'; ... % 'ammonium exchange';
        'EX_o2(e)'; ... % 'oxygen exchange'; 
        'EX_pi(e)'; ... % 'phosphate exchange';
        'EX_so4(e)'; ... % 'sulphate exchange';
        };
    glucoseExchange = {...
        'EX_glc(e)'; ... % D-glucose exchange'
        };
    uptakeRxnIndexes = findRxnIDs(model,desiredExchanges);
    glucoseExchangeIndex = findRxnIDs(model,glucoseExchange);
    if length(uptakeRxnIndexes) ~= 4;
        error('Not all exchange reactions were found.')
    end
    model.lb(uptakeRxnIndexes)=-1000;
    model.lb(glucoseExchangeIndex)=-10;
end
   
function model = minimal_iMMbz(model)
    % change iMM model media to minimal - ammonium, glucose, oxygen,
    % phosphate, sulphate
    
    % iMMbz version also requires Fe2 to enable heme biosynthesis
    
    % start with a clean slate: set all exchange reactions to upper bound =
    % 1000 and lower bound = 0 (ie, unconstrained excretion, no uptake)
    exchangeRxns = findExcRxns(model);
    model.lb(exchangeRxns) = 0;
    model.ub(exchangeRxns) = 1000;
    desiredExchanges = {...
        'EX_nh4(e)'; ... % 'ammonium exchange';
        'EX_o2(e)'; ... % 'oxygen exchange'; 
        'EX_pi(e)'; ... % 'phosphate exchange';
        'EX_so4(e)'; ... % 'sulphate exchange'; 
        'EX_fe2(e)'; ... % 'Fe2 exchange';
        };
    glucoseExchange = {...
        'EX_glc(e)'; ... % D-glucose exchange'
        };
    uptakeRxnIndexes = findRxnIDs(model,desiredExchanges);
    glucoseExchangeIndex = findRxnIDs(model,glucoseExchange);
    if length(uptakeRxnIndexes) ~= 5;
        error('Not all exchange reactions were found.')
    end
    model.lb(uptakeRxnIndexes)=-1000;
    model.lb(glucoseExchangeIndex)=-10;
end

function model = minimal_iAZ(model)
    % change iAZ model media to minimal - ammonium, glucose, oxygen,
    % phosphate, sulphate
                
    % start with a clean slate: set all exchange reactions to upper bound =
    % 1000 and lower bound = 0 (ie, unconstrained excretion, no uptake)
    exchangeRxns = findExcRxns(model);
    model.lb(exchangeRxns) = 0;
    model.ub(exchangeRxns) = 1000;
    desiredExchanges = {...
        'EX_nh4(e)'; ... % 'ammonium exchange';
        'EX_o2(e)'; ... % 'oxygen exchange'; 
        'EX_pi(e)'; ... % 'phosphate exchange';
        'EX_so4(e)'; ... % 'sulphate exchange'; 
        };
    glucoseExchange = {...
        'EX_glc(e)'; ... % D-glucose exchange'
        };
    uptakeRxnIndexes = findRxnIDs(model,desiredExchanges);
    glucoseExchangeIndex = findRxnIDs(model,glucoseExchange);
    if length(uptakeRxnIndexes) ~= 4;
        error('Not all exchange reactions were found.')
    end
    model.lb(uptakeRxnIndexes)=-1000;
    model.lb(glucoseExchangeIndex)=-10;
end

function model = minimal_Y4(model)
    % change Y4 model media to minimal - ammonium, glucose, oxygen,
    % phosphate, sulphate
    
    % This one is hard b/c nonstandard exchange bounds, directions.

    % start with a clean slate (ie, unconstrained excretion, no uptake)
    exchangeRxns = findExcRxns(model);
    exchange_indexes=find(exchangeRxns);

    %thanks to Shuyi Ma (of the Price lab at ISB) for this!
    b2 = sum(model.S(:,exchange_indexes),1); %-1 for exchange as reactant +1 for exchange as product
    posexch = exchange_indexes(b2 == 1); % index of exchange rxns having product
    negexch = exchange_indexes(b2 == -1); % index of exchange rxns having substrate

    model.lb(posexch) = -1000;
    model.ub(posexch) = 0;

    model.lb(negexch) = 0;
    model.ub(negexch) = 1000;

    % now allow uptake of media components
    desiredPosExchanges = {...
        'r_1157'; ... % 'ammonia exchange';
        'r_1435'; ... % 'oxygen exchange';
        'r_1461'; ... % 'phosphate exchange';
        'r_1507'; ... % 'sulfate uniport ';
        };
    glucosePosExchange = {...
        'r_1293'; ... % 'glucose transport' - should be ub=10 (was 0 10)
        };

    desiredPosExchangesIndexes = findRxnIDs(model,desiredPosExchanges);
    glucosePosExchangeIndex = findRxnIDs(model,glucosePosExchange);
    if length(desiredPosExchangesIndexes) ~= 4;
        error('Not all exchange reactions were found.')
    end
    model.ub(desiredPosExchangesIndexes)=1000;
    model.ub(glucosePosExchangeIndex)=10;
end

function model = minimal_Y5(model)
    % change Y5 model media to minimal - ammonium, glucose, oxygen,
    % phosphate, sulphate
                
    % start with a clean slate: set all exchange reactions to upper bound =
    % 1000 and lower bound = 0 (ie, unconstrained excretion, no uptake)
    exchangeRxns = findExcRxns(model);
    model.lb(exchangeRxns) = 0;
    model.ub(exchangeRxns) = 1000;
    desiredExchanges = {...
        'r_1654'; ... % 'ammonium exchange';
        'r_1992'; ... % 'oxygen exchange'; 
        'r_2005'; ... % 'phosphate exchange';
        'r_2060'; ... % 'sulphate exchange'; 
        };
    glucoseExchange = {...
        'r_1714'; ... % 'D-glucose exchange'
        };
    uptakeRxnIndexes = findRxnIDs(model,desiredExchanges);
    glucoseExchangeIndex = findRxnIDs(model,glucoseExchange);
    if length(uptakeRxnIndexes) ~= 4;
        error('Not all exchange reactions were found.')
    end
    model.lb(uptakeRxnIndexes)=-1000;
    model.lb(glucoseExchangeIndex)=-10;
end

function model = minimal_Y6(model)
    % change Y6 model media to minimal - ammonium, glucose, oxygen,
    % phosphate, sulphate
    
    % start with a clean slate: set all exchange reactions to
    % upper bound = 1000 and lower bound = 0 (ie, unconstrained
    % excretion, no uptake)
    exchangeRxns = findExcRxns(model);
    model.lb(exchangeRxns) = 0;
    model.ub(exchangeRxns) = 1000;
    desiredExchanges = {...
        'r_1654'; ... % 'ammonium exchange';
        'r_1992'; ... % 'oxygen exchange'; 
        'r_2005'; ... % 'phosphate exchange';
        'r_2060'; ... % 'sulphate exchange';
        %'r_1861'; ... % iron for test of expanded biomass def;
        };
    glucoseExchange = {...
        'r_1714'; ... % D-glucose exchange'
        };
    uptakeRxnIndexes = findRxnIDs(model,desiredExchanges);
    glucoseExchangeIndex = findRxnIDs(model,glucoseExchange);
    if length(uptakeRxnIndexes) ~= 4;%5;
        error('Not all exchange reactions were found.')
    end
    model.lb(uptakeRxnIndexes)=-1000;
    model.lb(glucoseExchangeIndex)=-10;
end
    
function model = minimal_iIN(model)
    % change iIN model media to minimal - ammonium, glucose, oxygen,
    % phosphate, sulphate
    
    % start with a clean slate: set all exchange reactions to
    % unconstrained excretion, no uptake.
    
    % iIN also requires TAG and phosphatidate to enable growth
    
    uptake_rxn_ids = {'44DIMZYMSTxtI';'ACALxtI';'ACxtI';'ADNxtI';...
        'ADxtI';'AKGxtI';'ALAVxtI';'ALAxtI';'AMGxtI';'AONAxtI';...
        'ARABxtI';'ARGxtI';'ASNxtI';'ASPxtI';'ATNxtI';'ATTxtI';...
        'BMxtI';'BTxtI';'C100xtI';'C120xtI';'C140xtI';'C141xtI';...
        'C160xtI';'C161xtI';'C180xtI';'C181xtI';'C24xtI';'C26xtI';...
        'CARxtI';'CHOxtI';'CITxtI';'CO2xtI';'CYSxtI';'CYTDxtI';...
        'CYTSxtI';'DANNAxtI';'DAxtI';'DCxtI';'DGxtI';'DINxtI';...
        'DIPEPxtI';'DTTPxtI';'DTxtI';'DUxtI';'EPISTxtI';...
        'ERG572224xtI';'ERG722xtI';'ERGOSTxtI';'ETHxtI';...
        'FCOSTxtI';'FORxtI';'FRUxtI';'FUCxtI';'FUMxtI';'GA6PxtI';...
        'GABAxtI';'GLACxtI';'GLALxtI';'GLAMxtI';'GLCxtI';'GLNxtI';...
        'GLTxtI';'GLUxtI';'GLxtI';'GLYxtI';'GNxtI';'GROPCxtI';...
        'GROPIxtI';'GSNxtI';'HEXTI';'HISxtI';'HYXNxtI';'ILExtI';...
        'INSxtI';'KxtI';'LACxtI';'LANOSTxtI';'LEUxtI';'LYSxtI';...
        'MALxtI';'MANxtI';'MELIxtI';'METxtI';'MIxtI';'MLTxtI';...
        'MMETxtI';'MNTxtI';'MTHNxtI';'NAGxtI';'NAxtI';'NH3xtI';...
        'NMNxtI';'O2xtI';'OGTxtI';'OPEPxtI';'ORNxtI';'PAPxtI';...
        'PEPTxtI';'PHExtI';'PIMExtI';'PIxtI';'PNTOxtI';'PROxtI';...
        'PTRSCxtI';'PYRxtI';'RFLAVxtI';'RIBxtI';'RMNxtI';'SAMxtI';...
        'SERxtI';'SLFxtI';'SORxtI';'SPRMDxtI';'SPRMxtI';'SUCCxtI';...
        'SUCxtI';'THMxtI';'THRxtI';'THYxtI';'TRExtI';'TRPxtI';...
        'TYRxtI';'URAxtI';'UREAxtI';'URIxtI';'VALxtI';'VB6xtI';...
        'XANxtI';'XTSINExtI';'XYLxtI';'ZYMSTxtI';};

    excretion_rxn_ids = {'44DIMZYMSTxtO';'ACALxtO';'ACxtO';...
        'ADNxtO';'ADxtO';'AKGxtO';'ALAVxtO';'ALAxtO';'AMGxtO';...
        'AONAxtO';'ARABxtO';'ARGxtO';'ASNxtO';'ASPxtO';'ATNxtO';...
        'ATTxtO';'BMxtO';'BTxtO';'C100xtO';'C120xtO';'C140xtO';...
        'C141xtO';'C160xtO';'C161xtO';'C180xtO';'C181xtO';...
        'C24xtO';'C26xtO';'CARxtO';'CHOxtO';'CITxtO';'CO2xtO';...
        'CYSxtO';'CYTDxtO';'CYTSxtO';'DANNAxtO';'DAxtO';'DCxtO';...
        'DGxtO';'DINxtO';'DIPEPxtO';'DTTPxtO';'DTxtO';'DUxtO';...
        'EPISTxtO';'ERG572224xtO';'ERG722xtO';'ERGOSTxtO';...
        'ETHxtO';'FCOSTxtO';'FORxtO';'FRUxtO';'FUCxtO';'FUMxtO';...
        'GA6PxtO';'GABAxtO';'GLACxtO';'GLALxtO';'GLAMxtO';...
        'GLCxtO';'GLNxtO';'GLTxtO';'GLUxtO';'GLxtO';'GLYxtO';...
        'GNxtO';'GROPCxtO';'GROPIxtO';'GSNxtO';'HEXTO';'HISxtO';...
        'HYXNxtO';'ILExtO';'INSxtO';'KxtO';'LACxtO';'LANOSTxtO';...
        'LEUxtO';'LYSxtO';'MALxtO';'MANxtO';'MELIxtO';'METxtO';...
        'MIxtO';'MLTxtO';'MMETxtO';'MNTxtO';'MTHNxtO';'NAGxtO';...
        'NAxtO';'NH3xtO';'NMNxtO';'O2xtO';'OGTxtO';'OPEPxtO';...
        'ORNxtO';'PAPxtO';'PEPTxtO';'PHExtO';'PIMExtO';'PIxtO';...
        'PNTOxtO';'PROxtO';'PTRSCxtO';'PYRxtO';'RFLAVxtO';...
        'RIBxtO';'RMNxtO';'SAMxtO';'SERxtO';'SLFxtO';'SORxtO';...
        'SPRMDxtO';'SPRMxtO';'SUCCxtO';'SUCxtO';'THMxtO';'THRxtO';...
        'THYxtO';'TRExtO';'TRPxtO';'TYRxtO';'URAxtO';'UREAxtO';...
        'URIxtO';'VALxtO';'VB6xtO';'XANxtO';'XTSINExtO';'XYLxtO';...
        'ZYMSTxtO';};

        uptake_rxn_indexes = findRxnIDs(model,uptake_rxn_ids);
        excretion_rxn_indexes = findRxnIDs(model,excretion_rxn_ids);
        
        model.lb(uptake_rxn_indexes)=0;
        model.ub(uptake_rxn_indexes)=0;
        
        model.lb(excretion_rxn_indexes)=0;
        model.ub(excretion_rxn_indexes)=1000;
        
    % now allow uptake of media components
    desiredExchanges = {...
        'NH3xtI'; ... % 'ammonia exchange';
        'O2xtI'; ... % 'oxygen exchange';
        'PIxtI'; ... % 'phosphate exchange';
        'SLFxtI'; ... % 'sulfate uniport ';       
        };
    glucoseExchange = {...
        'GLCxtI'; ... % 'glucose transport' - should be ub=10 (was 0 10)
        };

    desiredExchangesIndexes = findRxnIDs(model,desiredExchanges);
    glucoseExchangeIndex = findRxnIDs(model,glucoseExchange);
    if length(desiredExchangesIndexes) ~= length(desiredExchanges);
        error('Not all exchange reactions were found.')
    end
    model.ub(desiredExchangesIndexes)=1000;
    model.ub(glucoseExchangeIndex)=10;
end

function model = minimal_iIN2(model)
    % change iIN model media to minimal - ammonium, glucose, oxygen,
    % phosphate, sulphate
    
    % start with a clean slate: set all exchange reactions to
    % unconstrained excretion, no uptake.
       
    uptake_rxn_ids = {'44DIMZYMSTxtI';'ACALxtI';'ACxtI';'ADNxtI';...
        'ADxtI';'AKGxtI';'ALAVxtI';'ALAxtI';'AMGxtI';'AONAxtI';...
        'ARABxtI';'ARGxtI';'ASNxtI';'ASPxtI';'ATNxtI';'ATTxtI';...
        'BMxtI';'BTxtI';'C100xtI';'C120xtI';'C140xtI';'C141xtI';...
        'C160xtI';'C161xtI';'C180xtI';'C181xtI';'C24xtI';'C26xtI';...
        'CARxtI';'CHOxtI';'CITxtI';'CO2xtI';'CYSxtI';'CYTDxtI';...
        'CYTSxtI';'DANNAxtI';'DAxtI';'DCxtI';'DGxtI';'DINxtI';...
        'DIPEPxtI';'DTTPxtI';'DTxtI';'DUxtI';'EPISTxtI';...
        'ERG572224xtI';'ERG722xtI';'ERGOSTxtI';'ETHxtI';...
        'FCOSTxtI';'FORxtI';'FRUxtI';'FUCxtI';'FUMxtI';'GA6PxtI';...
        'GABAxtI';'GLACxtI';'GLALxtI';'GLAMxtI';'GLCxtI';'GLNxtI';...
        'GLTxtI';'GLUxtI';'GLxtI';'GLYxtI';'GNxtI';'GROPCxtI';...
        'GROPIxtI';'GSNxtI';'HEXTI';'HISxtI';'HYXNxtI';'ILExtI';...
        'INSxtI';'KxtI';'LACxtI';'LANOSTxtI';'LEUxtI';'LYSxtI';...
        'MALxtI';'MANxtI';'MELIxtI';'METxtI';'MIxtI';'MLTxtI';...
        'MMETxtI';'MNTxtI';'MTHNxtI';'NAGxtI';'NAxtI';'NH3xtI';...
        'NMNxtI';'O2xtI';'OGTxtI';'OPEPxtI';'ORNxtI';'PAPxtI';...
        'PEPTxtI';'PHExtI';'PIMExtI';'PIxtI';'PNTOxtI';'PROxtI';...
        'PTRSCxtI';'PYRxtI';'RFLAVxtI';'RIBxtI';'RMNxtI';'SAMxtI';...
        'SERxtI';'SLFxtI';'SORxtI';'SPRMDxtI';'SPRMxtI';'SUCCxtI';...
        'SUCxtI';'THMxtI';'THRxtI';'THYxtI';'TRExtI';'TRPxtI';...
        'TYRxtI';'URAxtI';'UREAxtI';'URIxtI';'VALxtI';'VB6xtI';...
        'XANxtI';'XTSINExtI';'XYLxtI';'ZYMSTxtI';};

    excretion_rxn_ids = {'44DIMZYMSTxtO';'ACALxtO';'ACxtO';...
        'ADNxtO';'ADxtO';'AKGxtO';'ALAVxtO';'ALAxtO';'AMGxtO';...
        'AONAxtO';'ARABxtO';'ARGxtO';'ASNxtO';'ASPxtO';'ATNxtO';...
        'ATTxtO';'BMxtO';'BTxtO';'C100xtO';'C120xtO';'C140xtO';...
        'C141xtO';'C160xtO';'C161xtO';'C180xtO';'C181xtO';...
        'C24xtO';'C26xtO';'CARxtO';'CHOxtO';'CITxtO';'CO2xtO';...
        'CYSxtO';'CYTDxtO';'CYTSxtO';'DANNAxtO';'DAxtO';'DCxtO';...
        'DGxtO';'DINxtO';'DIPEPxtO';'DTTPxtO';'DTxtO';'DUxtO';...
        'EPISTxtO';'ERG572224xtO';'ERG722xtO';'ERGOSTxtO';...
        'ETHxtO';'FCOSTxtO';'FORxtO';'FRUxtO';'FUCxtO';'FUMxtO';...
        'GA6PxtO';'GABAxtO';'GLACxtO';'GLALxtO';'GLAMxtO';...
        'GLCxtO';'GLNxtO';'GLTxtO';'GLUxtO';'GLxtO';'GLYxtO';...
        'GNxtO';'GROPCxtO';'GROPIxtO';'GSNxtO';'HEXTO';'HISxtO';...
        'HYXNxtO';'ILExtO';'INSxtO';'KxtO';'LACxtO';'LANOSTxtO';...
        'LEUxtO';'LYSxtO';'MALxtO';'MANxtO';'MELIxtO';'METxtO';...
        'MIxtO';'MLTxtO';'MMETxtO';'MNTxtO';'MTHNxtO';'NAGxtO';...
        'NAxtO';'NH3xtO';'NMNxtO';'O2xtO';'OGTxtO';'OPEPxtO';...
        'ORNxtO';'PAPxtO';'PEPTxtO';'PHExtO';'PIMExtO';'PIxtO';...
        'PNTOxtO';'PROxtO';'PTRSCxtO';'PYRxtO';'RFLAVxtO';...
        'RIBxtO';'RMNxtO';'SAMxtO';'SERxtO';'SLFxtO';'SORxtO';...
        'SPRMDxtO';'SPRMxtO';'SUCCxtO';'SUCxtO';'THMxtO';'THRxtO';...
        'THYxtO';'TRExtO';'TRPxtO';'TYRxtO';'URAxtO';'UREAxtO';...
        'URIxtO';'VALxtO';'VB6xtO';'XANxtO';'XTSINExtO';'XYLxtO';...
        'ZYMSTxtO';};

        uptake_rxn_indexes = findRxnIDs(model,uptake_rxn_ids);
        excretion_rxn_indexes = findRxnIDs(model,excretion_rxn_ids);
        
        model.lb(uptake_rxn_indexes)=0;
        model.ub(uptake_rxn_indexes)=0;
        
        model.lb(excretion_rxn_indexes)=0;
        model.ub(excretion_rxn_indexes)=1000;
        
    % now allow uptake of media components
    desiredExchanges = {...
        'NH3xtI'; ... % 'ammonia exchange';
        'O2xtI'; ... % 'oxygen exchange';
        'PIxtI'; ... % 'phosphate exchange';
        'SLFxtI'; ... % 'sulfate uniport ';       
        };
    glucoseExchange = {...
        'GLCxtI'; ... % 'glucose transport' - should be ub=10 (was 0 10)
        };

    desiredExchangesIndexes = findRxnIDs(model,desiredExchanges);
    glucoseExchangeIndex = findRxnIDs(model,glucoseExchange);
    if length(desiredExchangesIndexes) ~= length(desiredExchanges);
        error('Not all exchange reactions were found.')
    end
    model.ub(desiredExchangesIndexes)=1000;
    model.ub(glucoseExchangeIndex)=10;
end

function model = minimal_iTO(model)
    % change iTO model media to minimal - ammonium, glucose, oxygen,
    % phosphate, sulphate
    
    % start with a clean slate: set all exchange reactions to
    % unconstrained excretion, no uptake.
    
    uptake_rxn_ids = {'2MBACxtI';'2MBALDxtI';'44DIMZYMSTxtI';...
        'ACALxtI';'ACxtI';'ADNxtI';'ADxtI';'AKGxtI';'ALAVxtI';'ALAxtI';...
        'AMGxtI';'AONAxtI';'ARABxtI';'ARGxtI';'ASNxtI';'ASPxtI';...
        'ATNxtI';'ATTxtI';'BMxtI';'BTxtI';'C100xtI';'C120xtI';...
        'C140xtI';'C141xtI';'C160xtI';'C161xtI';'C180xtI';'C181xtI';...
        'C24xtI';'C26xtI';'CARxtI';'CHOxtI';'CITxtI';'CO2xtI';'CYSxtI';...
        'CYTDxtI';'CYTSxtI';'DANNAxtI';'DAxtI';'DCxtI';'DGxtI';...
        'DINxtI';'DIPEPxtI';'DTTPxtI';'DTxtI';'DUxtI';'EPISTxtI';...
        'ERG572224xtI';'ERG722xtI';'ERGOSTxtI';'ETHAxtI';'ETHxtI';...
        'FCOSTxtI';'FORxtI';'FRUxtI';'FUCxtI';'FUMxtI';'GA6PxtI';...
        'GABAxtI';'GLACxtI';'GLALxtI';'GLAMxtI';'GLCxtI';'GLNxtI';...
        'GLTxtI';'GLUxtI';'GLxtI';'GLYxtI';'GNxtI';'GROPCxtI';...
        'GROPIxtI';'GSNxtI';'HEXTI';'HISxtI';'HYXNxtI';'ILExtI';...
        'INSxtI';'KxtI';'LACxtI';'LANOSTxtI';'LEUxtI';'LYSxtI';...
        'MALxtI';'MANxtI';'MELIxtI';'METxtI';'MIxtI';'MLTxtI';...
        'MMETxtI';'MNTxtI';'MTHNxtI';'NAGxtI';'NAxtI';'NH3xtI';...
        'NMNxtI';'O2xtI';'OGTxtI';'OPEPxtI';'ORNxtI';'PAPxtI';...
        'PEPTxtI';'PHExtI';'PIMExtI';'PIxtI';'PNTOxtI';'PROxtI';...
        'PTRSCxtI';'PYRxtI';'RFLAVxtI';'RIBxtI';'RMNxtI';'SAMxtI';...
        'SERxtI';'SLFxtI';'SORxtI';'SPRMDxtI';'SPRMxtI';'SUCCxtI';...
        'SUCxtI';'THMxtI';'THRxtI';'THYxtI';'TRExtI';'TRPxtI';'TYRxtI';...
        'URAxtI';'UREAxtI';'URIxtI';'VALxtI';'VB6xtI';'XANxtI';...
        'XTSINExtI';'XYLxtI';'ZYMSTxtI';'DSERxtI'};
    
    excretion_rxn_ids = {'2MBACxtO';'44DIMZYMSTxtO';'ACALxtO';'ACxtO';...
        'ADNxtO';'ADxtO';'AKGxtO';'ALAVxtO';'ALAxtO';'AMGxtO';...
        'AONAxtO';'ARABxtO';'ARGxtO';'ASNxtO';'ASPxtO';'ATNxtO';...
        'ATTxtO';'BMxtO';'BTxtO';'C100xtO';'C120xtO';'C140xtO';...
        'C141xtO';'C160xtO';'C161xtO';'C180xtO';'C181xtO';'C24xtO';...
        'C26xtO';'CARxtO';'CHOxtO';'CITxtO';'CO2xtO';'CYSxtO';...
        'CYTDxtO';'CYTSxtO';'DANNAxtO';'DAxtO';'DCxtO';'DGxtO';...
        'DINxtO';'DIPEPxtO';'DTTPxtO';'DTxtO';'DUxtO';'EPISTxtO';...
        'ERG572224xtO';'ERG722xtO';'ERGOSTxtO';'ETHxtO';'FCOSTxtO';...
        'FORxtO';'FRUxtO';'FUCxtO';'FUMxtO';'GA6PxtO';'GABAxtO';...
        'GLACxtO';'GLALxtO';'GLAMxtO';'GLCxtO';'GLNxtO';'GLTxtO';...
        'GLUxtO';'GLxtO';'GLYxtO';'GNxtO';'GROPCxtO';'GROPIxtO';...
        'GSNxtO';'HEXTO';'HISxtO';'HYXNxtO';'ILExtO';'INSxtO';'KxtO';...
        'LACxtO';'LANOSTxtO';'LEUxtO';'LYSxtO';'MALxtO';'MANxtO';...
        'MELIxtO';'METxtO';'MIxtO';'MLTxtO';'MMETxtO';'MNTxtO';...
        'MTHNxtO';'NAGxtO';'NAxtO';'NH3xtO';'NMNxtO';'O2xtO';'OGTxtO';...
        'OPEPxtO';'ORNxtO';'PAPxtO';'PEPTxtO';'PHExtO';'PIMExtO';...
        'PIxtO';'PNTOxtO';'PROxtO';'PTRSCxtO';'PYRxtO';'RFLAVxtO';...
        'RIBxtO';'RMNxtO';'SAMxtO';'SERxtO';'SLFxtO';'SORxtO';...
        'SPRMDxtO';'SPRMxtO';'SUCCxtO';'SUCxtO';'THMxtO';'THRxtO';...
        'THYxtO';'TRExtO';'TRPxtO';'TYRxtO';'URAxtO';'UREAxtO';...
        'URIxtO';'VALxtO';'VB6xtO';'XANxtO';'XTSINExtO';'XYLxtO';...
        'ZYMSTxtO';'DSERxtO'};

        uptake_rxn_indexes = findRxnIDs(model,uptake_rxn_ids);
        excretion_rxn_indexes = findRxnIDs(model,excretion_rxn_ids);
        
        model.lb(uptake_rxn_indexes)=0;
        model.ub(uptake_rxn_indexes)=0;
        
        model.lb(excretion_rxn_indexes)=0;
        model.ub(excretion_rxn_indexes)=1000;
        
    % now allow uptake of media components
    desiredExchanges = {...
        'NH3xtI'; ... % 'ammonia exchange';
        'O2xtI'; ... % 'oxygen exchange';
        'PIxtI'; ... % 'phosphate exchange';
        'SLFxtI'; ... % 'sulfate uniport ';       
        };
    glucoseExchange = {...
        'GLCxtI'; ... % 'glucose transport' - should be ub=10 (was 0 10)
        };

    desiredExchangesIndexes = findRxnIDs(model,desiredExchanges);
    glucoseExchangeIndex = findRxnIDs(model,glucoseExchange);
    if length(desiredExchangesIndexes) ~= length(desiredExchanges);
        error('Not all exchange reactions were found.')
    end
    model.ub(desiredExchangesIndexes)=1000;
    model.ub(glucoseExchangeIndex)=10;
end

function model = minimal_bio(model)
    % change bio model media to minimal - ammonium, glucose, oxygen,
    % phosphate, sulphate. Add L-tyrosine (met bigg_tyr_L_bm), L-lysine
    % (met bigg_lys_L_bm), L-isoleucine (met bigg_ile_L_bm), L-arginine
    % (met bigg_arg_L_bm), L-histidine (met bigg_his_L_bm), L-methionine
    % (met bigg_met_L_bm), and L-tryptophan (bigg_trp_L_bm) to enable
    % growth.
    
    % start with a clean slate: set uptake exchange reactions to
    % upper bound = 0 and lower bound = 0 (ie, unconstrained
    % excretion, no uptake)
 
    uptakeRxns = findRxnIDs(model, ...
        {'MNXR6704_i'; 'MNXM99_in'; 'MNXM105_in'; 'MNXM15_in'; ...
        'MNXM27_in'; 'MNXM95_in'; 'MNXM653_in'; 'MNXM128_in'; ...
        'MNXM58_in'; 'MNXM43_in'; 'MNXM9_in'; 'MNXM1_in'; 'MNXM2_in'; ...
        'MNXM13_in'; 'MNXM4_in';});

    otherRxns = setdiff(find(findExcRxns(model)), uptakeRxns);

    model.ub(uptakeRxns) = 0;
    model.ub(otherRxns) = 1000;
    model.lb(otherRxns) = 0;
    
    desiredExchanges = {...
        'MNXM15_in'; ... % 'ammonium exchange';
        'MNXM4_in'; ... % 'oxygen exchange'; 
        'MNXM9_in'; ... % 'phosphate exchange';
        'MNXM58_in'; ... % 'sulphate exchange';
        };
    glucoseExchange = {...
        'MNXM105_in'; ... % D-glucose exchange'
        };
    uptakeRxnIndexes = findRxnIDs(model,desiredExchanges);
    glucoseExchangeIndex = findRxnIDs(model,glucoseExchange);
    
    if length(uptakeRxnIndexes) ~= 4;%5;
        error('Not all exchange reactions were found.')
    end
    
    model.ub(uptakeRxnIndexes)=1000;
    model.ub(glucoseExchangeIndex)=10;
    
    % add L-tyrosine by allowing the bigg_tyr_L_out rxn to be reversible
    model.lb(findRxnIDs(model,'bigg_tyr_L_out')) = -1000;
    
    % add L-lysine by allowing the met bigg_lys_L_out rxn to be reversible
    model.lb(findRxnIDs(model,'bigg_lys_L_out')) = -1000;

    % add L-isoleucine by allowing the met bigg_ile_L_out rxn to be
    % reversible
    model.lb(findRxnIDs(model,'bigg_ile_L_out')) = -1000;

    % add L-arginine by allowing the met bigg_arg_L_out rxn to be
    % reversible
    model.lb(findRxnIDs(model,'bigg_arg_L_out')) = -1000;

    % add L-histidine by allowing the met bigg_his_L_out rxn to be
    % reversible
    model.lb(findRxnIDs(model,'bigg_his_L_out')) = -1000;
    
    % add L-methionine by allowing the met bigg_met_L_out rxn to be
    % reversible
    model.lb(findRxnIDs(model,'bigg_met_L_out')) = -1000;
    
    % add L-tryptophan by allowing the met bigg_trp_L_out rxn to be
    % reversible
    model.lb(findRxnIDs(model,'bigg_trp_L_out')) = -1000;
end

%% functions to set iFF708 biomass def
function model = set_iTO_iFF_biomass(model)
    % change iTO model use iFF708 biomass def
    % clear the current biomass def
    rxn_index = findRxnIDs(model,'CBIOMASS');
    model.S(find(model.S(:,rxn_index)),rxn_index) = 0;
    model=changeRxnMets(model,...
        {'m160';'m584';'m339';'m340';'m358';'m618';'m621';...
        'm624';'m627';'m682';'m683';'m415';'m440';'m442';...
        'm444';'m447';'m451';'m457';'m458';'m461';'m466';...
        'm469';'m471';'m473';'m476';'m478';'m481';'m483';...
        'm485';'m487';'m489';'m732';'m816';'m562';'m724';...
        'm335';'m600';'m768';}, ... %mets to change
        {'m160';'m174';'m584';'m339';'m340';'m358';'m618';...
        'm621';'m624';'m627';'m662';'m682';'m683';'m415';...
        'm440';'m442';'m444';'m447';'m451';'m457';'m458';...
        'm461';'m466';'m469';'m471';'m473';'m476';'m478';...
        'm481';'m483';'m485';'m487';'m489';'m732';'m769';...
        'm772';'m773';'m774';'m816';'m884';'m562';'m894';...
        'm335';'m600';'m768';}, ... %new mets
        {'CBIOMASS';}, ... %rxn id
        [-1.1348;-0.0053;-0.0234;-0.0460;-59.276;-0.0447;...
        -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
        -0.5185;-0.0460;-0.4588;-0.1607;-0.1017;-0.2975;...
        -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
        -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
        -0.0284;-0.1020;-0.2646;-0.8079;-0.0006;-0.0060;...
        -0.0045;-0.0017;-0.0200;-0.0066;-0.0599;-0.0015;...
        59.276;1;59.3050;]); %stoichiometric coefficients
end

function model = set_iND_iFF_biomass(model)
    % change iND model use iFF708 biomass def
    % clear the current biomass def
    rxn_index = findRxnIDs(model,'biomass_SC4_bal');
    model.S(find(model.S(:,rxn_index)),rxn_index) = 0;
    model=changeRxnMets(model,...
        {'13BDglcn[c]';'ala-L[c]';'amp[c]';'arg-L[c]';...
        'asn-L[c]';'asp-L[c]';'atp[c]';'cmp[c]';'cys-L[c]';...
        'damp[c]';'dcmp[c]';'dgmp[c]';'dtmp[c]';'ergst[c]';...
        'gln-L[c]';'glu-L[c]';'gly[c]';'glycogen[c]';'gmp[c]';...
        'h2o[c]';'his-L[c]';'ile-L[c]';'leu-L[c]';'lys-L[c]';...
        'mannan[c]';'met-L[c]';'pa_SC[c]';'pc_SC[c]';...
        'pe_SC[c]';'phe-L[c]';'pro-L[c]';'ps_SC[c]';...
        'ptd1ino_SC[c]';'ser-L[c]';'so4[c]';...
        'thr-L[c]';'tre[c]';'triglyc_SC[c]';'trp-L[c]';...
        'tyr-L[c]';'ump[c]';'val-L[c]';'zymst[c]';'adp[c]';...
        'h[c]';'pi[c]';}, ... %mets to change
        {'13BDglcn[c]';'ptd1ino_SC[c]';'tre[c]';'amp[c]';...
        'atp[c]';'cmp[c]';'damp[c]';'dcmp[c]';'dgmp[c]';...
        'dtmp[c]';'ergst[c]';'gly[c]';'glycogen[c]';'gmp[c]';...
        'ala-L[c]';'arg-L[c]';'asn-L[c]';'asp-L[c]';'cys-L[c]';...
        'glu-L[c]';'gln-L[c]';'his-L[c]';'ile-L[c]';'leu-L[c]';...
        'lys-L[c]';'met-L[c]';'phe-L[c]';'pro-L[c]';'ser-L[c]';...
        'thr-L[c]';'trp-L[c]';'tyr-L[c]';'val-L[c]';...
        'mannan[c]';'pa_SC[c]';'pc_SC[c]';'pe_SC[c]';...
        'ps_SC[c]';'so4[c]';'triglyc_SC[c]';'ump[c]';...
        'zymst[c]';'adp[c]';'pi[c]';}, ... %new mets
        {'biomass_SC4_bal';}, ... %rxn id
        [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
        -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
        -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
        -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
        -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
        -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
        -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
        59.276;59.305;]); %stoichiometric coefficients
end

function model = set_iIN_COBRA_iFF_biomass(model)
    % change iIN model use iFF708 biomass def
    % clear the current biomass def
    rxn_index = findRxnIDs(model,'CBIOMASS');
    model.S(find(model.S(:,rxn_index)),rxn_index) = 0;
    model=changeRxnMets(model,...
        {'m29';'m241';'m253';'m262';'m316';'m365';'m370';...
        'm391';'m413';'m483';'m485';'m490';'m554';'m557';...
        'm559';'m562';'m569';'m575';'m578';'m583';'m588';...
        'm593';'m597';'m601';'m606';'m609';'m613';'m616';...
        'm620';'m624';'m627';'m633';'m648';'m864';'m966';...
        'm230';'m272';'m733';}, ... %mets to change
        {'m29';'m38';'m241';'m253';'m262';'m316';'m365';...
        'm370';'m391';'m413';'m429';'m483';'m485';'m490';...
        'm554';'m557';'m559';'m562';'m569';'m575';'m578';...
        'm583';'m588';'m593';'m597';'m601';'m606';'m609';...
        'm613';'m616';'m620';'m624';'m627';'m648';'m757';...
        'm761';'m762';'m766';'m864';'m928';'m966';'m984';...
        'm230';'m272';'m733';}, ... %new mets
        {'CBIOMASS';}, ... %rxn id
        [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
        -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
        -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
        -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
        -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
        -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
        -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
        59.276;1;59.305;]); %stoichiometric coefficients
end
 
function model = set_iIN_iFF_biomass(model)
    % change iIN model use iFF708 biomass def
    % note: iIN800 doesn't include the species "phosphatidate",
    % so not an exact iFF biomass def
    % clear the current biomass def
    rxn_index = findRxnIDs(model,'CBIOMASS');
    model.S(find(model.S(:,rxn_index)),rxn_index) = 0;
    model = changeRxnMets(model, ...
        {'1,3-beta-D-glucan [c]';...
        'alpha,alpha-trehalose [c]';'AMP [c]';'ATP [c]';...
        'CMP [c]';'dAMP [c]';'dCMP [c]';'dGMP [c]';...
        'dTMP [c]';'glycine [c]';'glycogen [c]';...
        'GMP [c]';'L-alanine [c]';'L-arginine [c]';...
        'L-asparagine [c]';'L-aspartate [c]';...
        'L-cysteine [c]';'L-glutamate [c]';...
        'L-glutamine [c]';'L-histidine [c]';...
        'L-isoleucine [c]';'L-leucine [c]';...
        'L-lysine [c]';'L-methionine [c]';...
        'L-phenylalanine [c]';'L-proline [c]';...
        'L-serine [c]';'L-threonine [c]';...
        'L-tryptophan [c]';'L-tyrosine [c]';...
        'L-valine [c]';'lipids [c]';'mannan [c]';...
        'sulfate [c]';'UMP [c]';'ADP [c]';'biomass [c]';...
        'phosphate [c]'}, ... %mets to change
        {'1,3-beta-D-glucan [c]';...
        '1-phosphatidyl-1D-myo-inositols [c]';...
        'alpha,alpha-trehalose [c]';'AMP [c]';'ATP [c]';...
        'CMP [c]';'dAMP [c]';'dCMP [c]';'dGMP [c]';...
        'dTMP [c]';'ergosterol [c]';'glycine [c]';...
        'glycogen [c]';'GMP [c]';'L-alanine [c]';...
        'L-arginine [c]';'L-asparagine [c]';...
        'L-aspartate [c]';'L-cysteine [c]';...
        'L-glutamate [c]';'L-glutamine [c]';...
        'L-histidine [c]';'L-isoleucine [c]';...
        'L-leucine [c]';'L-lysine [c]';'L-methionine [c]';...
        'L-phenylalanine [c]';'L-proline [c]';...
        'L-serine [c]';'L-threonine [c]';...
        'L-tryptophan [c]';'L-tyrosine [c]';...
        'L-valine [c]';'mannan [c]';...
        'phosphatidylcholines [c]';...
        'phosphatidylethanolamines [c]';...
        'phosphatidylserine [c]';'sulfate [c]';...
        'triglycerides [c]';'UMP [c]';'zymosterol [c]';...
        'ADP [c]';'biomass [c]';'phosphate [c]'}, ... %new mets
        {'CBIOMASS';}, ... %rxn id
        [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
        -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
        -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
        -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
        -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
        -0.0284;-0.102;-0.2646;-0.8079;-0.0006;...
        -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
        59.276;1;59.305;]); %stoichiometric coefficients
end

function model = set_iMM_iFF_biomass(model)
    % change iMM model use iFF708 biomass def
    % clear the current biomass def
    rxn_index = findRxnIDs(model,'biomass_SC5_notrace');
    model.S(find(model.S(:,rxn_index)),rxn_index) = 0;
    model=changeRxnMets(model,...
        {'13BDglcn[c]';'ala-L[c]';'amp[c]';'arg-L[c]';...
        'asn-L[c]';'asp-L[c]';'atp[c]';'cmp[c]';'cys-L[c]';...
        'damp[c]';'dcmp[c]';'dgmp[c]';'dtmp[c]';'ergst[c]';...
        'gln-L[c]';'glu-L[c]';'gly[c]';'glycogen[c]';'gmp[c]';...
        'h2o[c]';'his-L[c]';'ile-L[c]';'leu-L[c]';'lys-L[c]';...
        'mannan[c]';'met-L[c]';'pa_SC[c]';'pc_SC[c]';...
        'pe_SC[c]';'phe-L[c]';'pro-L[c]';'ps_SC[c]';...
        'ptd1ino_SC[c]';'ribflv[c]';'ser-L[c]';'so4[c]';...
        'thr-L[c]';'tre[c]';'triglyc_SC[c]';'trp-L[c]';...
        'tyr-L[c]';'ump[c]';'val-L[c]';'zymst[c]';'adp[c]';...
        'h[c]';'pi[c]';}, ... %mets to change
        {'13BDglcn[c]';'ptd1ino_SC[c]';'tre[c]';'amp[c]';...
        'atp[c]';'cmp[c]';'damp[c]';'dcmp[c]';'dgmp[c]';...
        'dtmp[c]';'ergst[c]';'gly[c]';'glycogen[c]';'gmp[c]';...
        'ala-L[c]';'arg-L[c]';'asn-L[c]';'asp-L[c]';'cys-L[c]';...
        'glu-L[c]';'gln-L[c]';'his-L[c]';'ile-L[c]';'leu-L[c]';...
        'lys-L[c]';'met-L[c]';'phe-L[c]';'pro-L[c]';'ser-L[c]';...
        'thr-L[c]';'trp-L[c]';'tyr-L[c]';'val-L[c]';...
        'mannan[c]';'pa_SC[c]';'pc_SC[c]';'pe_SC[c]';...
        'ps_SC[c]';'so4[c]';'triglyc_SC[c]';'ump[c]';...
        'zymst[c]';'adp[c]';'pi[c]';}, ... %new mets 
        {'biomass_SC5_notrace';}, ... %rxn id
        [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
        -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
        -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
        -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
        -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
        -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
        -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
        59.276;59.305;]); %stoichiometric coefficients
end

function model = set_iAZ_iFF_biomass(model)
    % change iAZ model use iFF708 biomass def
    % clear the current biomass def
    rxn_index = findRxnIDs(model,'biomass_wild');
    model.S(find(model.S(:,rxn_index)),rxn_index) = 0;
    model=changeRxnMets(model,...
        {'13BDglcn[c]';'16BDglcn[c]';'alatrna[c]';'amp[c]';...
        'argtrna[c]';'asntrna[c]';'asptrna[c]';'atp[c]';...
        'cmp[c]';'cystrna[c]';'damp[c]';'dcmp[c]';'dgmp[c]';...
        'dtmp[c]';'glntrna[c]';'glutrna[c]';'glycogen[c]';...
        'glytrna[c]';'gmp[c]';'h2o[c]';'histrna[c]';...
        'iletrna[c]';'leutrna[c]';'lystrna[c]';'mannan[c]';...
        'mettrna[c]';'pa_SC[c]';'pe_SC[c]';'phetrna[c]';...
        'phospholipid[c]';'protrna[c]';'ps_SC[c]';...
        'ptd1ino_SC[c]';'ribflv[c]';'sertrna[c]';'so4[c]';...
        'sterol[c]';'thrtrna[c]';'tre[c]';'triglyc_SC[c]';...
        'trptrna[c]';'tyrtrna[c]';'ump[c]';'valtrna[c]';...
        'zymst[c]';'adp[c]';'h[c]';'pi[c]';'trnaala[c]';...
        'trnaarg[c]';'trnaasn[c]';'trnaasp[c]';'trnacys[c]';...
        'trnagln[c]';'trnaglu[c]';'trnagly[c]';'trnahis[c]';...
        'trnaile[c]';'trnaleu[c]';'trnalys[c]';'trnamet[c]';...
        'trnaphe[c]';'trnapro[c]';'trnaser[c]';'trnathr[c]';...
        'trnatrp[c]';'trnatyr[c]';'trnaval[c]';}, ... %mets to change
        {'13BDglcn[c]';'ptd1ino_SC[c]';'tre[c]';'amp[c]';...
        'atp[c]';'cmp[c]';'damp[c]';'dcmp[c]';'dgmp[c]';...
        'dtmp[c]';'ergst[c]';'gly[c]';'glycogen[c]';'gmp[c]';...
        'ala_L[c]';'arg_L[c]';'asn_L[c]';'asp_L[c]';'cys_L[c]';...
        'glu_L[c]';'gln_L[c]';'his_L[c]';'ile_L[c]';'leu_L[c]';...
        'lys_L[c]';'met_L[c]';'phe_L[c]';'pro_L[c]';'ser_L[c]';...
        'thr_L[c]';'trp_L[c]';'tyr_L[c]';'val_L[c]';...
        'mannan[c]';'pa_SC[c]';'pc_SC[c]';'pe_SC[c]';...
        'ps_SC[c]';'so4[c]';'triglyc_SC[c]';'ump[c]';...
        'zymst[c]';'adp[c]';'pi[c]';}, ... %new mets
        {'biomass_wild';}, ... %rxn id
        [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
        -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
        -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
        -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
        -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
        -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
        -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
        59.276;59.305;]); %stoichiometric coefficients
end

function model = set_Y4_iFF_biomass(model)
    % change theYeast 4.05 model use iFF708 biomass def
    % clear the current biomass def
    rxn_index = findRxnIDs(model,'r_1812');
    model.S(find(model.S(:,rxn_index)),rxn_index) = 0;
    model=changeRxnMets(model,...
        {'s_0002';'s_0416';'s_0434';'s_0446';'s_0511';...
        's_0564';'s_0569';'s_0593';'s_0619';'s_0740';'s_0743';...
        's_0752';'s_0863';'s_0873';'s_0877';'s_0881';'s_0889';...
        's_0899';'s_0907';'s_0911';'s_0920';'s_0925';'s_0929';...
        's_0933';'s_0936';'s_0939';'s_0943';'s_0949';'s_0952';...
        's_0955';'s_0960';'s_1000';'s_1011';'s_1283';'s_1347';...
        's_1417';'s_0400';'s_0463';'s_1207';}, ... %mets to change
        {'s_0002';'s_0091';'s_0416';'s_0434';'s_0446';...
        's_0511';'s_0564';'s_0569';'s_0593';'s_0619';'s_0636';...
        's_0740';'s_0743';'s_0752';'s_0863';'s_0873';'s_0877';...
        's_0881';'s_0889';'s_0899';'s_0907';'s_0911';'s_0920';...
        's_0925';'s_0929';'s_0933';'s_0936';'s_0939';'s_0943';...
        's_0949';'s_0952';'s_0955';'s_0960';'s_1011';'s_1216';...
        's_1229';'s_1234';'s_1220';'s_1347';'s_1399';'s_1417';...
        's_1448';'s_0400';'s_0463';'s_1207';}, ... %new mets
        {'r_1812';}, ... %rxn id
        [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
        -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
        -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
        -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
        -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
        -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
        -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
        59.276;1;59.305;]); %stoichiometric coefficients
end

function model = set_Y5_iFF_biomass(model)
    % change theYeast 5.01 model use iFF708 biomass def
    % clear the current biomass def
    rxn_index = findRxnIDs(model,'r_2110');
    model.S(find(model.S(:,rxn_index)),rxn_index) = 0;
    model=changeRxnMets(model,...
        {'s_0002';'s_0423';'s_0434';'s_0526';'s_0584';...
        's_0589';'s_0615';'s_0649';'s_0773';'s_0782';'s_0803';...
        's_0955';'s_0965';'s_0969';'s_0973';'s_0981';'s_0991';...
        's_0999';'s_1003';'s_1006';'s_1016';'s_1021';'s_1025';...
        's_1029';'s_1032';'s_1035';'s_1039';'s_1045';'s_1048';...
        's_1051';'s_1056';'s_1096';'s_1107';'s_1405';'s_1467';...
        's_1520';'s_1545';'s_0394';'s_0450';'s_0794';...
        's_1322';}, ... %mets to change
        {'s_0002';'s_0089';'s_1520';'s_0423';'s_0434';...
        's_0526';'s_0584';'s_0589';'s_0615';'s_0649';'s_0666';...
        's_1003';'s_0773';'s_0782';'s_0955';'s_0965';'s_0969';...
        's_0973';'s_0981';'s_0991';'s_0999';'s_1006';'s_1016';...
        's_1021';'s_1025';'s_1029';'s_1032';'s_1035';'s_1039';...
        's_1045';'s_1048';'s_1051';'s_1056';'s_1107';'s_1331';...
        's_1346';'s_1351';'s_1337';'s_1467';'s_1524';'s_1545';...
        's_1569';'s_0394';'s_0450';'s_1322';}, ... %new mets
        {'r_2110';}, ... %rxn id
        [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
        -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
        -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
        -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
        -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
        -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
        -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
        59.276;1;59.305;]); %stoichiometric coefficients
end

function model = set_Y6_iFF_biomass(model)
% clear the current biomass def
rxn_index = findRxnIDs(model,'r_2133');
model.S(find(model.S(:,rxn_index)),rxn_index) = 0;
    % change the Yeast 6.06 model use iFF708 biomass def
    model=changeRxnMets(model,...
        {'s_0002';'s_0423';'s_0434';'s_0526';'s_0584';...
        's_0589';'s_0615';'s_0649';'s_0773';'s_0782';'s_0803';...
        's_0955';'s_0965';'s_0969';'s_0973';'s_0981';'s_0991';...
        's_0999';'s_1003';'s_1006';'s_1016';'s_1021';'s_1025';...
        's_1029';'s_1032';'s_1035';'s_1039';'s_1045';'s_1048';...
        's_1051';'s_1056';'s_1096';'s_1107';'s_1405';'s_1467';...
        's_1520';'s_1545';'s_0394';'s_0450';'s_0794';...
        's_1322';}, ... %mets to change
        {'s_0002';'s_0089';'s_1520';'s_0423';'s_0434';...
        's_0526';'s_0584';'s_0589';'s_0615';'s_0649';'s_0666';...
        's_1003';'s_0773';'s_0782';'s_0955';'s_0965';'s_0969';...
        's_0973';'s_0981';'s_0991';'s_0999';'s_1006';'s_1016';...
        's_1021';'s_1025';'s_1029';'s_1032';'s_1035';'s_1039';...
        's_1045';'s_1048';'s_1051';'s_1056';'s_1107';'s_1331';...
        's_1346';'s_1351';'s_1337';'s_1467';'s_1524';'s_1545';...
        's_1569';'s_0394';'s_0450';'s_1322';}, ... %new mets
        {'r_2133';}, ... %rxn id
        [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
        -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
        -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
        -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
        -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
        -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
        -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
        59.276;1;59.305;]); %stoichiometric coefficients
end

function model = set_iMM_NAD_iFF_biomass(model)
    % change the iMM904 NAD corrected model use iFF708 biomass def
    rxn_index = findRxnIDs(model,'biomass_published');
    model.S(find(model.S(:,rxn_index)),rxn_index) = 0;

    model=changeRxnMets(model,...
        {'13BDglcn[c]';'ala_L[c]';'amp[c]';'arg_L[c]';...
        'asn_L[c]';'asp_L[c]';'atp[c]';'camp[c]';...
        'chitin[c]';'cmp[c]';'coa[c]';'cys_L[c]';...
        'damp[c]';'dcmp[c]';'dgmp[c]';'dtmp[c]';'ergst[c]';...
        'fad[c]';'gln_L[c]';'glu_L[c]';'gly[c]';...
        'glycogen[c]';'gmp[c]';'gthrd[c]';'h2o[c]';...
        'his_L[c]';'ile_L[c]';'leu_L[c]';'lys_L[c]';...
        'mannan[c]';'met_L[c]';'nad[c]';'pa_SC[c]';...
        'pc_SC[c]';'pe_SC[c]';'phe_L[c]';'pheme[m]';...
        'pro_L[c]';'ps_SC[c]';'ptd1ino_SC[c]';'q6[m]';...
        'ribflv[c]';'ser_L[c]';'so4[c]';'thf[c]';...
        'thmtp[c]';'thr_L[c]';'tre[c]';'triglyc_SC[c]';'trp_L[c]';...
        'tyr_L[c]';'ump[c]';'val_L[c]';'zymst[c]';'adp[c]';...
        'h[c]';'pi[c]';}, ... %mets to change
        {'13BDglcn[c]';'ptd1ino_SC[c]';'tre[c]';'amp[c]';...
        'atp[c]';'cmp[c]';'damp[c]';'dcmp[c]';'dgmp[c]';...
        'dtmp[c]';'ergst[c]';'gly[c]';'glycogen[c]';'gmp[c]';...
        'ala_L[c]';'arg_L[c]';'asn_L[c]';'asp_L[c]';'cys_L[c]';...
        'glu_L[c]';'gln_L[c]';'his_L[c]';'ile_L[c]';'leu_L[c]';...
        'lys_L[c]';'met_L[c]';'phe_L[c]';'pro_L[c]';'ser_L[c]';...
        'thr_L[c]';'trp_L[c]';'tyr_L[c]';'val_L[c]';...
        'mannan[c]';'pa_SC[c]';'pc_SC[c]';'pe_SC[c]';...
        'ps_SC[c]';'so4[c]';'triglyc_SC[c]';'ump[c]';...
        'zymst[c]';'adp[c]';'pi[c]';}, ... %new mets 
        {'biomass_published';}, ... %rxn id
        [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
        -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
        -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
        -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
        -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
        -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
        -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
        59.276;59.305;]); %stoichiometric coefficients
end
                               
function model = set_Y7_iFF_biomass(model)
% clear the current biomass def
rxn_index = findRxnIDs(model,'r_2133');
model.S(find(model.S(:,rxn_index)),rxn_index) = 0;
    % change the Yeast 7 model use iFF708 biomass def
    model=changeRxnMets(model,...
        {'s_0002';'s_0423';'s_0434';'s_0526';'s_0584';...
        's_0589';'s_0615';'s_0649';'s_0773';'s_0782';'s_0803';...
        's_0955';'s_0965';'s_0969';'s_0973';'s_0981';'s_0991';...
        's_0999';'s_1003';'s_1006';'s_1016';'s_1021';'s_1025';...
        's_1029';'s_1032';'s_1035';'s_1039';'s_1045';'s_1048';...
        's_1051';'s_1056';'s_1096';'s_1107';'s_1405';'s_1467';...
        's_1520';'s_1545';'s_0394';'s_0450';'s_0794';...
        's_1322';}, ... %mets to change
        {'s_0002';'s_0089';'s_1520';'s_0423';'s_0434';...
        's_0526';'s_0584';'s_0589';'s_0615';'s_0649';'s_0666';...
        's_1003';'s_0773';'s_0782';'s_0955';'s_0965';'s_0969';...
        's_0973';'s_0981';'s_0991';'s_0999';'s_1006';'s_1016';...
        's_1021';'s_1025';'s_1029';'s_1032';'s_1035';'s_1039';...
        's_1045';'s_1048';'s_1051';'s_1056';'s_1107'; ...
        's_2954';... %-Y7 doesn't have phosphatidate [cytoplasm] (met 1190, s_1331), use s_2954 instead
        's_1346';'s_1351';'s_1337';'s_1467';'s_1524';'s_1545';...
        's_1569';'s_0394';'s_0450';'s_1322';}, ... %new mets         
        {'r_2133';}, ... %rxn id
        [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
        -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
        -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
        -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
        -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
        -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
        -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
        59.276;1;59.305;]); %stoichiometric coefficients
end

function model = set_bio_iFF_biomass(model)
    % clear the current biomass def
    rxn_index = findRxnIDs(model,'BIOMASS_REACTION');
    model.S(find(model.S(:,rxn_index)),rxn_index) = 0;
    % change the biomodelsDB model use iFF708 biomass def
    model=changeRxnMets(model,...
        {'bigg_gly_bm'; 'bigg_tyr_L_bm'; 'bigg_asp_L_bm'; ...
        'bigg_lys_L_bm'; 'bigg_thr_L_bm'; 'bigg_ile_L_bm'; ...
        'bigg_leu_L_bm'; 'bigg_val_L_bm'; 'bigg_arg_L_bm'; ...
        'bigg_asn_L_bm'; 'MNXM18_bm'; 'bigg_gln_L_bm'; ...
        'bigg_pro_L_bm'; 'bigg_his_L_bm'; 'bigg_ala_L_bm'; ...
        'bigg_ser_L_bm'; 'bigg_cys_L_bm'; 'bigg_met_L_bm'; ...
        'bigg_phe_L_bm'; 'bigg_trp_L_bm'; 'bigg_amp_bm'; ...
        'bigg_gmp_bm'; 'bigg_cmp_bm'; 'bigg_ump_bm'; ...
        'bigg_damp_bm'; 'bigg_dgmp_bm'; 'bigg_dcmp_bm'; ...
        'bigg_dtmp_bm'; 'MNXM876_bm'; 'bigg_atp_bm'; ...
        'bigg_adp_bm'; 'bigg_pi_bm';}, ... %mets to change
        {'MNXM2056[i]'; 'MNXM62[i]'; 'bigg_tre[i]'; ...
        'bigg_amp_bm'; 'bigg_atp_bm'; 'bigg_cmp_bm'; ...
        'bigg_damp_bm'; 'bigg_dcmp_bm'; 'bigg_dgmp_bm'; ...
        'bigg_dtmp_bm'; 'bigg_ergst[i]'; 'bigg_gly_bm'; ...
        'MNXM876_bm'; 'bigg_gmp_bm'; 'bigg_ala_L_bm'; ...
        'bigg_arg_L_bm'; 'bigg_asn_L_bm'; 'bigg_asp_L_bm'; ...
        'bigg_cys_L_bm'; 'MNXM18_bm'; 'bigg_gln_L_bm'; ...
        'bigg_his_L_bm'; 'bigg_ile_L_bm'; 'bigg_leu_L_bm'; ...
        'bigg_lys_L_bm'; 'bigg_met_L_bm'; 'bigg_phe_L_bm'; ...
        'bigg_pro_L_bm'; 'bigg_ser_L_bm'; 'bigg_thr_L_bm'; ...
        'bigg_trp_L_bm'; 'bigg_tyr_L_bm'; 'bigg_val_L_bm'; ...
        'MNXM30402[i]'; 'MNXM17312[i]'; 'MNXM96041[i]'; ...
        'bigg_ethamp[i]'; 'MNXM36806[i]'; 'bigg_so4[i]'; ...
        'MNXM248[i]'; 'bigg_ump_bm'; 'bigg_zymst[i]'; ...
        'bigg_adp_bm'; 'bigg_pi_bm';}, ... %new mets
        {'BIOMASS_REACTION';}, ... %rxn id
        [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
        -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
        -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
        -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
        -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
        -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
        -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
        59.276;59.305;]); %stoichiometric coefficients
end